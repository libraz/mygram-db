# MygramDB v1.3.6 Release Notes

**Release Date:** 2025-11-26
**Type:** Maintenance Release
**Previous Version:** v1.3.5

---

## Overview

Version 1.3.6 is a maintenance release focused on cache efficiency improvements and log cleanliness for production deployments.

**Highlights:**

- **Cache hit rate improvement** - LIMIT/OFFSET excluded from cache keys
- **Cleaner production logs** - Startup/shutdown messages demoted to debug level

---

## Performance Improvements

### 1. Cache Key Optimization

**Type:** Performance

Exclude LIMIT and OFFSET from cache key generation to significantly improve cache hit rates.

**Problem:** Identical queries with different pagination parameters (e.g., `LIMIT 10 OFFSET 0` vs `LIMIT 10 OFFSET 10`) created separate cache entries storing the same full results. This caused:

- Cache hit rate as low as ~0.67% due to pagination variations
- Duplicate storage of identical full result sets
- Wasted memory for paginated API requests

**Solution:**

- `QueryNormalizer::Normalize()` no longer appends LIMIT/OFFSET to cache key
- Cache stores full results, pagination applied on retrieval
- Single cache entry serves all pagination variants of the same query

**Benefits:**

- Significantly improved cache hit rate
- Reduced memory usage by eliminating duplicate full result storage
- Better cache utilization for paginated API requests

**Files Changed:**

- `src/query/query_normalizer.cpp` - Remove LIMIT/OFFSET from key generation
- `src/query/query_normalizer.h` - Updated documentation

---

## Refactoring

### 1. Log Verbosity Reduction

**Type:** Refactoring

Demote routine startup/shutdown messages from info to debug level for cleaner production logs.

**Key Changes:**

Log level adjustments (info -> debug):

- `src/app/application.cpp` - Main loop entry/exit and dump directory verification
- `src/app/server_orchestrator.cpp` - Table initialization, MySQL connection, snapshot build, and replication GTID messages
- `src/server/tcp_server.cpp` - Server stopping/stopped messages
- `src/server/connection_acceptor.cpp` - Accept loop start/stop and listening messages
- `src/server/thread_pool.cpp` - Pool creation and shutdown messages
- `src/server/table_catalog.cpp` - Catalog initialization message
- `src/server/server_lifecycle_manager.cpp` - All component initialization messages
- `src/mysql/connection.cpp` - Connection success message

Structured logging adoption:

- `src/config/config.cpp` - Replace multiple info logs with single structured `config_loaded` event containing path, table count, mysql_host, and mysql_port

Duplicate log removal:

- `src/app/server_orchestrator.cpp` - Remove redundant "TCP server started" and "Stopping TCP server" messages (already logged by tcp_server.cpp)

---

## Files Changed

| File | Changes |
|------|---------|
| `src/query/query_normalizer.cpp` | Remove LIMIT/OFFSET from cache key |
| `src/query/query_normalizer.h` | Updated documentation |
| `src/app/application.cpp` | Log level adjustments |
| `src/app/server_orchestrator.cpp` | Log level adjustments, duplicate removal |
| `src/config/config.cpp` | Structured logging adoption |
| `src/mysql/connection.cpp` | Log level adjustment |
| `src/server/connection_acceptor.cpp` | Log level adjustments |
| `src/server/server_lifecycle_manager.cpp` | Log level adjustments |
| `src/server/table_catalog.cpp` | Log level adjustment |
| `src/server/tcp_server.cpp` | Log level adjustments |
| `src/server/thread_pool.cpp` | Log level adjustments |
| `tests/cache/query_normalizer_test.cpp` | Verify LIMIT/OFFSET excluded |
| `tests/integration/cache/pagination_test.cpp` | Strengthen cache statistics test |

---

## Upgrade Instructions

### From v1.3.5 or earlier

1. Stop MygramDB
2. Upgrade to v1.3.6
3. Restart MygramDB

No configuration changes required.

---

## Known Issues

None.

---

## Migration Notes

No migration required. This is a backward-compatible release.
